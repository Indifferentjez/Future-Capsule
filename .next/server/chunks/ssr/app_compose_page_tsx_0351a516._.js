module.exports=[85016,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(50944),e=a.i(73785),f=a.i(69240),g=a.i(40695),h=a.i(17171),i=a.i(5522),j=a.i(97895);let k=c.forwardRef(({className:a,children:c,...d},e)=>(0,b.jsx)("select",{ref:e,className:(0,j.cn)("flex h-10 w-full rounded-md border border-border bg-transparent px-3 py-2 text-sm ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",a),...d,children:c}));k.displayName="Select";let l=["January","February","March","April","May","June","July","August","September","October","November","December"];function m({onNext:a}){let c=(0,e.useComposeStore)(a=>a.deliverMode),d=(0,e.useComposeStore)(a=>a.deliverAt),f=(0,e.useComposeStore)(a=>a.birthdayDay),j=(0,e.useComposeStore)(a=>a.birthdayMonth),m=(0,e.useComposeStore)(a=>a.timezone)??Intl.DateTimeFormat().resolvedOptions().timeZone,n=(0,e.useComposeStore)(a=>a.setDraft),o=a=>{if(n({deliverMode:a}),"date"===a&&!d){let a=new Date;a.setFullYear(a.getFullYear()+1),n({deliverAt:a.toISOString().slice(0,16)})}};return(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(h.Label,{children:"Delivery mode"}),(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsx)(g.Button,{type:"button",variant:"date"===c?"default":"outline",onClick:()=>o("date"),children:"Specific date"}),(0,b.jsx)(g.Button,{type:"button",variant:"birthday"===c?"default":"outline",onClick:()=>o("birthday"),children:"Birthday"})]})]}),"date"===c&&(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(h.Label,{htmlFor:"deliverAt",children:"Delivery date & time"}),(0,b.jsx)(i.Input,{id:"deliverAt",type:"datetime-local",value:d?d.slice(0,16):"",onChange:a=>n({deliverAt:a.target.value?new Date(a.target.value).toISOString():void 0}),min:new Date().toISOString().slice(0,16)})]}),"birthday"===c&&(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(h.Label,{htmlFor:"bday-month",children:"Month"}),(0,b.jsxs)(k,{id:"bday-month",value:j??"",onChange:a=>n({birthdayMonth:a.target.value?Number(a.target.value):void 0}),children:[(0,b.jsx)("option",{value:"",children:"Select"}),l.map((a,c)=>(0,b.jsx)("option",{value:c+1,children:a},a))]})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(h.Label,{htmlFor:"bday-day",children:"Day"}),(0,b.jsx)(i.Input,{id:"bday-day",type:"number",min:1,max:31,placeholder:"1–31",value:f??"",onChange:a=>n({birthdayDay:a.target.value?Number(a.target.value):void 0})})]})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(h.Label,{htmlFor:"timezone",children:"Timezone"}),(0,b.jsx)(i.Input,{id:"timezone",value:m,onChange:a=>n({timezone:a.target.value}),readOnly:!0,className:"bg-muted"})]}),(0,b.jsx)(g.Button,{type:"button",onClick:a,children:"Next"})]})}var n=a.i(70106);let o=(0,n.default)("Type",[["polyline",{points:"4 7 4 4 20 4 20 7",key:"1nosan"}],["line",{x1:"9",x2:"15",y1:"20",y2:"20",key:"swin9y"}],["line",{x1:"12",x2:"12",y1:"4",y2:"20",key:"1tx1rr"}]]),p=(0,n.default)("Mic",[["path",{d:"M12 2a3 3 0 0 0-3 3v7a3 3 0 0 0 6 0V5a3 3 0 0 0-3-3Z",key:"131961"}],["path",{d:"M19 10v2a7 7 0 0 1-14 0v-2",key:"1vc78b"}],["line",{x1:"12",x2:"12",y1:"19",y2:"22",key:"x3vr5v"}]]),q=(0,n.default)("Video",[["path",{d:"m16 13 5.223 3.482a.5.5 0 0 0 .777-.416V7.87a.5.5 0 0 0-.752-.432L16 10.5",key:"ftymec"}],["rect",{x:"2",y:"6",width:"14",height:"12",rx:"2",key:"158x01"}]]);function r({onNext:a}){let c=(0,e.useComposeStore)(a=>a.messageType),d=(0,e.useComposeStore)(a=>a.setDraft);return(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"How do you want to send your message?"}),(0,b.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4",children:[{id:"text",label:"Text",icon:o},{id:"audio",label:"Audio (max 2:00)",icon:p},{id:"video",label:"Video (max 1:30)",icon:q}].map(({id:a,label:e,icon:f})=>(0,b.jsxs)(g.Button,{type:"button",variant:c===a?"default":"outline",className:"h-auto flex flex-col gap-2 py-6",onClick:()=>d({messageType:a}),children:[(0,b.jsx)(f,{className:"h-8 w-8"}),(0,b.jsx)("span",{children:e})]},a))}),(0,b.jsx)(g.Button,{type:"button",onClick:a,disabled:!c,children:"Next"})]})}let s=c.forwardRef(({className:a,checked:c=!1,onCheckedChange:d,...e},f)=>(0,b.jsx)("button",{type:"button",role:"switch","aria-checked":c,ref:f,className:(0,j.cn)("peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50",c?"bg-foreground":"bg-muted",a),onClick:()=>d?.(!c),...e,children:(0,b.jsx)("span",{className:(0,j.cn)("pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform",c?"translate-x-5":"translate-x-1")})}));function t({onNext:a}){let c=(0,e.useComposeStore)(a=>a.guidedMode),d=(0,e.useComposeStore)(a=>a.setDraft);return(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between rounded-lg border border-border p-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)(h.Label,{htmlFor:"guided",className:"text-base font-medium",children:"Guided mode"}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground mt-1",children:"Show prompts while recording so you know what to talk about."})]}),(0,b.jsx)(s,{id:"guided",checked:c??!0,onCheckedChange:a=>d({guidedMode:a})})]}),(0,b.jsx)(g.Button,{type:"button",onClick:a,children:"Next"})]})}function u({onNext:a}){let d=(0,e.useComposeStore)(a=>a.guidedMode),h=(0,e.useComposeStore)(a=>a.selectedPromptIds)??[],i=(0,e.useComposeStore)(a=>a.setDraft),[k,l]=(0,c.useState)([]),[m,n]=(0,c.useState)(!0),o=(0,f.createClient)();if((0,c.useEffect)(()=>{o.from("prompts").select("id, category, time_horizon, intensity, text").then(({data:a})=>{l(a??[]),n(!1)})},[o]),!d)return(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsx)("p",{className:"text-muted-foreground",children:"Guided mode is off. Skip to your message."}),(0,b.jsx)(g.Button,{type:"button",onClick:a,children:"Next"})]});if(m)return(0,b.jsx)("p",{className:"text-muted-foreground",children:"Loading prompts…"});let p=k.reduce((a,b)=>((a[b.category]=a[b.category]??[]).push(b),a),{}),q=h.length>=3&&h.length<=6,r=Math.ceil(15*h.length/60);return(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsxs)("p",{className:"text-sm text-muted-foreground",children:["Pick 3–6 prompts. We’ll show them like a teleprompter while you record. (~",r," min total)"]}),(0,b.jsx)("div",{className:"space-y-4",children:Object.entries(p).map(([a,c])=>(0,b.jsxs)("div",{children:[(0,b.jsx)("h4",{className:"text-sm font-medium text-foreground mb-2",children:a}),(0,b.jsx)("div",{className:"flex flex-wrap gap-2",children:c.map(a=>(0,b.jsx)("button",{type:"button",onClick:()=>{var b;return b=a.id,void i({selectedPromptIds:h.includes(b)?h.filter(a=>a!==b):h.length<6?[...h,b]:h})},className:(0,j.cn)("rounded-md border px-3 py-2 text-left text-sm transition-colors",h.includes(a.id)?"border-foreground bg-foreground text-background":"border-border hover:border-foreground/50"),children:a.text},a.id))})]},a))}),(0,b.jsxs)("p",{className:"text-sm text-muted-foreground",children:["Selected: ",h.length," / ",6]}),(0,b.jsx)(g.Button,{type:"button",onClick:a,disabled:!q,children:"Next"})]})}s.displayName="Switch";var v=a.i(3130),w=a.i(46271),x=a.i(62036);function y({prompts:a,isRecording:d}){let[e,f]=(0,c.useState)(0);return((0,c.useEffect)(()=>{if(!d||0===a.length)return;let b=setTimeout(()=>{f(b=>(b+1)%a.length)},(12+6*Math.random())*1e3);return()=>clearTimeout(b)},[d,e,a.length]),0===a.length)?null:(0,b.jsx)("div",{className:"min-h-[4rem] flex items-center justify-center px-4",children:(0,b.jsx)(x.AnimatePresence,{mode:"wait",children:(0,b.jsx)(w.motion.p,{initial:{opacity:0,y:8},animate:{opacity:1,y:0},exit:{opacity:0,y:-8},transition:{duration:.4},className:"text-center text-lg text-foreground max-w-lg",children:a[e]?.text},a[e]?.id??e)})})}function z({onComplete:a,promptSnapshots:d,guidedMode:e}){let f,[h,i]=(0,c.useState)(!1),[j,k]=(0,c.useState)(120),[l,m]=(0,c.useState)(null),n=(0,c.useRef)(null),o=(0,c.useRef)([]),p=(0,c.useRef)(null),q=(0,c.useCallback)(()=>{p.current&&clearInterval(p.current),p.current=null,i(!1),n.current?.state==="recording"&&n.current.stop()},[]),r=async()=>{try{let a=await navigator.mediaDevices.getUserMedia({audio:!0}),b=new MediaRecorder(a);o.current=[],b.ondataavailable=a=>a.data.size&&o.current.push(a.data),b.onstop=()=>{a.getTracks().forEach(a=>a.stop());let b=new Blob(o.current,{type:"audio/webm"});m(b)},n.current=b,b.start(),i(!0),k(120),p.current=setInterval(()=>{k(a=>a<=1?(q(),0):a-1)},1e3)}catch(a){console.error(a)}};return l?(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"Recording saved. You can go back to re-record or proceed."}),(0,b.jsx)(g.Button,{type:"button",onClick:()=>{m(null)},children:"Re-record"}),(0,b.jsx)(g.Button,{type:"button",onClick:()=>a(l),children:"Use this recording"})]}):(0,b.jsxs)("div",{className:"space-y-6",children:[e&&d.length>0&&(0,b.jsx)(y,{prompts:d,isRecording:h}),(0,b.jsxs)("div",{className:"flex flex-col items-center gap-4",children:[(0,b.jsx)("span",{className:"text-2xl font-mono tabular-nums",children:(f=Math.floor(j/60),`${f}:${(j%60).toString().padStart(2,"0")}`)}),h?(0,b.jsx)(g.Button,{type:"button",variant:"destructive",onClick:q,children:"Stop"}):(0,b.jsx)(g.Button,{type:"button",onClick:r,children:"Start recording (max 2:00)"})]})]})}function A({onComplete:a,promptSnapshots:d,guidedMode:e}){let f,[h,i]=(0,c.useState)(!1),[j,k]=(0,c.useState)(90),[l,m]=(0,c.useState)(null),n=(0,c.useRef)(null),o=(0,c.useRef)(null),p=(0,c.useRef)(null),q=(0,c.useRef)([]),r=(0,c.useRef)(null),s=(0,c.useCallback)(()=>{r.current&&clearInterval(r.current),r.current=null,i(!1),o.current?.state==="recording"&&o.current.stop(),p.current?.getTracks().forEach(a=>a.stop())},[]),t=async()=>{try{let a=await navigator.mediaDevices.getUserMedia({video:!0,audio:!0});p.current=a,n.current&&(n.current.srcObject=a);let b=new MediaRecorder(a);q.current=[],b.ondataavailable=a=>a.data.size&&q.current.push(a.data),b.onstop=()=>{let a=new Blob(q.current,{type:"video/webm"});m(a)},o.current=b,b.start(),i(!0),k(90),r.current=setInterval(()=>{k(a=>a<=1?(s(),0):a-1)},1e3)}catch(a){console.error(a)}};return((0,c.useEffect)(()=>()=>{s()},[s]),l)?(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"Recording saved. You can go back to re-record or proceed."}),(0,b.jsx)(g.Button,{type:"button",onClick:()=>m(null),children:"Re-record"}),(0,b.jsx)(g.Button,{type:"button",onClick:()=>a(l),children:"Use this recording"})]}):(0,b.jsxs)("div",{className:"space-y-6",children:[e&&d.length>0&&(0,b.jsx)(y,{prompts:d,isRecording:h}),(0,b.jsxs)("div",{className:"relative rounded-lg overflow-hidden bg-muted aspect-video max-w-lg mx-auto",children:[(0,b.jsx)("video",{ref:n,autoPlay:!0,muted:!0,playsInline:!0,className:"w-full h-full object-cover"}),(0,b.jsx)("div",{className:"absolute bottom-2 left-2 font-mono text-white bg-black/70 px-2 py-1 rounded",children:(f=Math.floor(j/60),`${f}:${(j%60).toString().padStart(2,"0")}`)})]}),(0,b.jsx)("div",{className:"flex justify-center gap-2",children:h?(0,b.jsx)(g.Button,{type:"button",variant:"destructive",onClick:s,children:"Stop"}):(0,b.jsx)(g.Button,{type:"button",onClick:t,children:"Start recording (max 1:30)"})})]})}function B({onNext:a}){let d=(0,e.useComposeStore)(a=>a.messageType),g=(0,e.useComposeStore)(a=>a.textContent),i=(0,e.useComposeStore)(a=>a.guidedMode),j=(0,e.useComposeStore)(a=>a.selectedPromptIds)??[],k=(0,e.useComposeStore)(a=>a.setDraft),[l,m]=(0,c.useState)([]);return((0,c.useEffect)(()=>{0===j.length?m([]):(0,f.createClient)().from("prompts").select("id, text").in("id",j).then(({data:a})=>{m((a??[]).map(a=>({id:a.id,text:a.text})))})},[j]),"text"===d)?(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(h.Label,{htmlFor:"textContent",children:"Your message"}),(0,b.jsx)("textarea",{id:"textContent",className:"flex min-h-[200px] w-full rounded-md border border-border bg-transparent px-3 py-2 text-sm placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring",placeholder:"Write anything you want your future self to read…",value:g??"",onChange:a=>k({textContent:a.target.value})})]}),g&&(0,b.jsx)(v.Card,{className:"bg-muted/50",children:(0,b.jsx)(v.CardContent,{className:"p-4",children:(0,b.jsx)("p",{className:"text-sm whitespace-pre-wrap",children:g})})}),(0,b.jsx)("button",{type:"button",className:"inline-flex items-center justify-center rounded-md text-sm font-medium h-10 px-4 bg-foreground text-background hover:bg-foreground/90",onClick:a,children:"Next"})]}):"audio"===d?(0,b.jsx)("div",{className:"space-y-6",children:(0,b.jsx)(z,{promptSnapshots:l,guidedMode:i??!0,onComplete:b=>{k({mediaBlob:b}),a()}})}):"video"===d?(0,b.jsx)("div",{className:"space-y-6",children:(0,b.jsx)(A,{promptSnapshots:l,guidedMode:i??!0,onComplete:b=>{k({mediaBlob:b}),a()}})}):(0,b.jsx)("p",{className:"text-muted-foreground",children:"Select a message type in the previous step."})}function C({onNext:a}){let c=(0,e.useComposeStore)(a=>a.songTitle),d=(0,e.useComposeStore)(a=>a.songArtist),f=(0,e.useComposeStore)(a=>a.songUrl),j=(0,e.useComposeStore)(a=>a.setDraft);return(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"Optional: add a song that reminds you of this moment. We’ll store the link only (no playback in-app). Paste a Spotify or Apple Music URL."}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(h.Label,{htmlFor:"songUrl",children:"Song URL"}),(0,b.jsx)(i.Input,{id:"songUrl",type:"url",placeholder:"https://open.spotify.com/track/… or https://music.apple.com/…",value:f??"",onChange:a=>{var b;j({songUrl:(b=a.target.value)||null}),j({songTitle:null,songArtist:null})}})]}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(h.Label,{htmlFor:"songTitle",children:"Song title (optional)"}),(0,b.jsx)(i.Input,{id:"songTitle",value:c??"",onChange:a=>j({songTitle:a.target.value||null}),placeholder:"Title"})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(h.Label,{htmlFor:"songArtist",children:"Artist (optional)"}),(0,b.jsx)(i.Input,{id:"songArtist",value:d??"",onChange:a=>j({songArtist:a.target.value||null}),placeholder:"Artist"})]})]}),(0,b.jsx)(g.Button,{type:"button",onClick:a,children:"Next"})]})}let D=["open.spotify.com","music.apple.com","spotify.com","apple.co"];function E({onSuccess:a}){let d=(0,e.useComposeStore)(a=>({deliverMode:a.deliverMode,deliverAt:a.deliverAt,birthdayDay:a.birthdayDay,birthdayMonth:a.birthdayMonth,timezone:a.timezone,messageType:a.messageType,textContent:a.textContent,selectedPromptIds:a.selectedPromptIds,guidedMode:a.guidedMode,songTitle:a.songTitle,songArtist:a.songArtist,songUrl:a.songUrl,mediaBlob:a.mediaBlob,editMessageId:a.editMessageId})),[h,i]=(0,c.useState)(!1),[j,k]=(0,c.useState)(null),l=(0,f.createClient)(),m="birthday"===d.deliverMode?d.birthdayDay&&d.birthdayMonth?`Your birthday (${d.birthdayMonth}/${d.birthdayDay})`:"Birthday (set month/day)":d.deliverAt?new Date(d.deliverAt).toLocaleString():"—",n=async()=>{var b;i(!0),k(null);let c="text"===d.messageType?null==(b=d.textContent)||""===b?"Message content is required for text type.":b.length>5e4?"Text must be under 50000 characters.":null:null,f=function(a){if(!a)return null;try{let b=new URL(a);if(!D.some(a=>b.hostname===a||b.hostname.endsWith(`.${a}`)))return"Please use a Spotify or Apple Music link."}catch{return"Invalid URL."}return null}(d.songUrl);if(c||f){k(c??f??null),i(!1);return}try{let b,c,{data:{user:f}}=await l.auth.getUser();if(!f){k("Not signed in"),i(!1);return}if("birthday"===d.deliverMode&&null!=d.birthdayDay&&null!=d.birthdayMonth){let a=new Date,c=a.getFullYear(),e=new Date(c,d.birthdayMonth-1,d.birthdayDay);e<=a&&(e=new Date(c+1,d.birthdayMonth-1,d.birthdayDay)),b=e.toISOString()}else if(d.deliverAt)b=new Date(d.deliverAt).toISOString();else{k("Set delivery date"),i(!1);return}let g=(d.selectedPromptIds??[]).map(a=>({id:a,text:""})),h={type:d.messageType??"text",text_content:"text"===d.messageType?d.textContent??null:null,deliver_at:b,deliver_mode:d.deliverMode??"date",birthday_day:d.birthdayDay??null,birthday_month:d.birthdayMonth??null,timezone:d.timezone??null,guided_mode:d.guidedMode??!0,selected_prompts:g,song_title:d.songTitle??null,song_artist:d.songArtist??null,song_url:d.songUrl??null};if(d.editMessageId){let{error:a}=await l.from("messages").update(h).eq("id",d.editMessageId).eq("user_id",f.id);if(a){k(a.message),i(!1);return}if(c=d.editMessageId,d.mediaBlob){let a=`${f.id}/${c}/media.webm`,{error:b}=await l.storage.from("capsule-media").upload(a,d.mediaBlob,{upsert:!0});b||await l.from("messages").update({media_path:a}).eq("id",c)}}else{let{data:a,error:b}=await l.from("messages").insert({user_id:f.id,...h,media_path:null,status:"scheduled"}).select("id").single();if(b){k(b.message),i(!1);return}if(c=a.id,d.mediaBlob){let a=`${f.id}/${c}/media.webm`,{error:b}=await l.storage.from("capsule-media").upload(a,d.mediaBlob,{upsert:!0});if(b){k(b.message),i(!1);return}await l.from("messages").update({media_path:a}).eq("id",c)}}e.useComposeStore.getState().reset(),a()}catch(a){k(a instanceof Error?a.message:"Something went wrong")}i(!1)};return(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsx)(v.Card,{className:"bg-muted/50",children:(0,b.jsxs)(v.CardContent,{className:"p-4 space-y-2 text-sm",children:[(0,b.jsxs)("p",{children:[(0,b.jsx)("strong",{children:"Delivery:"})," ",m]}),(0,b.jsxs)("p",{children:[(0,b.jsx)("strong",{children:"Type:"})," ",d.messageType??"—"]}),(0,b.jsxs)("p",{children:[(0,b.jsx)("strong",{children:"Guided prompts:"})," ",(d.selectedPromptIds??[]).length]}),(0,b.jsxs)("p",{children:[(0,b.jsx)("strong",{children:"Song link:"})," ",d.songUrl?"Yes":"No"]})]})}),j&&(0,b.jsx)("p",{className:"text-sm text-red-600",children:j}),(0,b.jsx)(g.Button,{onClick:n,disabled:h,children:h?"Saving…":"Confirm & save"})]})}let F=[{id:"delivery",title:"When to deliver"},{id:"type",title:"Message type"},{id:"guided",title:"Guided mode"},{id:"prompts",title:"Prompts"},{id:"content",title:"Your message"},{id:"song",title:"Nostalgia song"},{id:"review",title:"Review"}];function G(){let a=(0,d.useRouter)(),h=(0,d.useSearchParams)(),[i,j]=(0,c.useState)(0),k=(0,e.useComposeStore)(a=>a.setDraft);(0,c.useEffect)(()=>{let a=h.get("preset");a&&["1y","5y","10y","custom","birthday"].includes(a)&&k({preset:a});let b=h.get("edit");b&&(k({editMessageId:b}),(0,f.createClient)().from("messages").select("*").eq("id",b).single().then(({data:a})=>{a&&k({deliverMode:a.deliver_mode,deliverAt:a.deliver_at,birthdayDay:a.birthday_day,birthdayMonth:a.birthday_month,timezone:a.timezone??void 0,messageType:a.type,guidedMode:a.guided_mode,selectedPromptIds:(a.selected_prompts??[]).map(a=>a.id),textContent:a.text_content??void 0,mediaPath:a.media_path??null,songTitle:a.song_title??null,songArtist:a.song_artist??null,songUrl:a.song_url??null})}))},[h,k]);let l=F[i],n=i<F.length-1,o=i>0,p=()=>{n&&j(a=>a+1)};return(0,b.jsx)("div",{className:"container max-w-2xl py-8 px-4",children:(0,b.jsxs)(v.Card,{children:[(0,b.jsxs)(v.CardHeader,{className:"pb-2",children:[(0,b.jsxs)(v.CardTitle,{className:"text-lg",children:["Step ",i+1,": ",l.title]}),(0,b.jsx)("div",{className:"flex gap-1 mt-2",children:F.map((a,c)=>(0,b.jsx)("button",{type:"button",onClick:()=>j(c),className:`h-1.5 flex-1 rounded-full transition-colors ${c<=i?"bg-foreground":"bg-muted"}`,"aria-label":`Go to step ${c+1}`},a.id))})]}),(0,b.jsxs)(v.CardContent,{className:"space-y-6",children:["delivery"===l.id&&(0,b.jsx)(m,{onNext:p}),"type"===l.id&&(0,b.jsx)(r,{onNext:p}),"guided"===l.id&&(0,b.jsx)(t,{onNext:p}),"prompts"===l.id&&(0,b.jsx)(u,{onNext:p}),"content"===l.id&&(0,b.jsx)(B,{onNext:p}),"song"===l.id&&(0,b.jsx)(C,{onNext:p}),"review"===l.id&&(0,b.jsx)(E,{onSuccess:()=>a.push("/inbox")}),(0,b.jsxs)("div",{className:"flex justify-between pt-4",children:[(0,b.jsx)(g.Button,{type:"button",variant:"outline",onClick:()=>{o&&j(a=>a-1)},disabled:!o,children:"Back"}),"review"!==l.id&&(0,b.jsx)(g.Button,{type:"button",onClick:p,disabled:!n,children:"Next"})]})]})]})})}function H(){return(0,b.jsx)(G,{})}a.s(["default",()=>H],85016)}];

//# sourceMappingURL=app_compose_page_tsx_0351a516._.js.map